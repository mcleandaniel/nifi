process_group:
  name: NiFi Flow
  process_groups:
    - name: Tools_Trust_Create
      description: |
        Create truststore directory (file created on first import). Operator-only; trigger via GenerateFlowFile Run once.
      processors:
        - id: gen-create
          name: Trigger (create)
          type: org.apache.nifi.processors.standard.GenerateFlowFile
          properties:
            Batch Size: "1"
            Scheduling Strategy: TIMER_DRIVEN
            Run Schedule: "24000 h"
        - id: ua-create
          name: Params (create)
          type: org.apache.nifi.processors.attributes.UpdateAttribute
          properties:
            ts.name: local-nifi
            ts.type: JKS
            ts.pass: changeMe123!
        - id: exec-create
          name: Exec (create)
          type: org.apache.nifi.processors.standard.ExecuteStreamCommand
          properties:
            Command Path: /bin/bash
            Command Arguments Strategy: Command Arguments Property
            Argument Delimiter: ";"
            Command Arguments: >-
              -lc;set -euo pipefail; TS_DIR=/opt/nifi/nifi-current/conf/truststores; mkdir -p "$TS_DIR"; echo "Ensured $TS_DIR"
            Ignore STDIN: "true"
            Working Directory: /opt/nifi
        - id: log-create
          name: Log (create)
          type: org.apache.nifi.processors.standard.LogAttribute
          properties: {}
      connections:
        - source: gen-create
          destination: ua-create
          relationships: [success]
        - source: ua-create
          destination: exec-create
          relationships: [success]
        - source: exec-create
          destination: log-create
          relationships: [output stream]
