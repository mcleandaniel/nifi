process_group:
  name: NiFi Flow
  position:
  - 0
  - 0
  process_groups:
  - name: TrivialFlow
    position:
    - 0
    - 0
    processors:
    - id: trivial-generate
      name: Generate FlowFile
      type: org.apache.nifi.processors.standard.GenerateFlowFile
      position:
      - 0
      - 0
      properties:
        Batch Size: '1'
    - id: trivial-log
      name: Log Attribute
      type: org.apache.nifi.processors.standard.LogAttribute
      position:
      - 400
      - 0
    connections:
    - name: Generate to Log
      source: trivial-generate
      destination: trivial-log
      relationships:
      - success
    auto_terminate:
      trivial-log:
      - success
  - name: SimpleWorkflow
    position:
    - 800
    - 0
    processors:
    - id: simple-generate
      name: GenerateRecord
      type: org.apache.nifi.processors.standard.GenerateRecord
      position:
      - 0
      - 0
      properties:
        record-writer: json-writer
        number-of-records: '1'
        nullable-fields: 'false'
        null-percentage: '0.0'
        schema-text: "{\n  \"type\": \"record\",\n  \"name\": \"test\",\n  \"fields\"\
          : [\n    { \"name\": \"status\", \"type\": \"string\" },\n    { \"name\"\
          : \"value\", \"type\": \"int\" }\n  ]\n}\n"
    - id: simple-update
      name: UpdateRecord
      type: org.apache.nifi.processors.standard.UpdateRecord
      position:
      - 400
      - 0
      properties:
        Record Reader: json-reader
        Record Writer: json-writer
        /status: UPPER(/status)
    - id: simple-query
      name: QueryRecord
      type: org.apache.nifi.processors.standard.QueryRecord
      position:
      - 800
      - 0
      properties:
        record-reader: json-reader
        record-writer: json-writer
        success: SELECT * FROM FLOWFILE WHERE status = 'OK'
        failure: SELECT * FROM FLOWFILE WHERE status <> 'OK'
    - id: simple-log-success
      name: LogAttribute (Success)
      type: org.apache.nifi.processors.standard.LogAttribute
      position:
      - 1200
      - -200
    - id: simple-log-failure
      name: LogAttribute (Failure)
      type: org.apache.nifi.processors.standard.LogAttribute
      position:
      - 1200
      - 200
    connections:
    - name: Generate to Update
      source: simple-generate
      destination: simple-update
      relationships:
      - success
    - name: Update to Query
      source: simple-update
      destination: simple-query
      relationships:
      - success
    - name: Query to Log Success
      source: simple-query
      destination: simple-log-success
      relationships:
      - success
    - name: Query to Log Failure
      source: simple-query
      destination: simple-log-failure
      relationships:
      - failure
    auto_terminate:
      simple-log-success:
      - success
      simple-log-failure:
      - success
  - name: MediumWorkflow
    position:
    - 1600
    - 0
    processors:
    - id: medium-generate
      name: Generate FlowFile (Medium)
      type: org.apache.nifi.processors.standard.GenerateFlowFile
      position:
      - 0
      - 0
      properties:
        Batch Size: '1'
        Data Format: Text
        Custom Text: route=success
    - id: medium-route
      name: Route On Attribute
      type: org.apache.nifi.processors.standard.RouteOnAttribute
      position:
      - 400
      - 0
      properties:
        success: ${route:equals('success')}
    - id: medium-log-success
      name: LogAttribute (Medium Success)
      type: org.apache.nifi.processors.standard.LogAttribute
      position:
      - 800
      - -200
    - id: medium-log-failure
      name: LogAttribute (Medium Failure)
      type: org.apache.nifi.processors.standard.LogAttribute
      position:
      - 800
      - 200
    connections:
    - name: Medium Generate to Route
      source: medium-generate
      destination: medium-route
      relationships:
      - success
    - name: Medium Route to Success
      source: medium-route
      destination: medium-log-success
      relationships:
      - success
    - name: Medium Route to Failure
      source: medium-route
      destination: medium-log-failure
      relationships:
      - unmatched
      - failure
    auto_terminate:
      medium-log-success:
      - success
      medium-log-failure:
      - success
  - name: ComplexWorkflow
    position:
    - 2400
    - 0
    processors:
    - id: complex-generate
      name: GenerateRecord (Complex)
      type: org.apache.nifi.processors.standard.GenerateRecord
      position:
      - 0
      - 0
      properties:
        record-writer: json-writer
        number-of-records: '1'
        nullable-fields: 'false'
        null-percentage: '0.0'
        schema-text: "{\n  \"type\": \"record\",\n  \"name\": \"reading\",\n  \"fields\"\
          : [\n    { \"name\": \"sensor\", \"type\": \"string\" },\n    { \"name\"\
          : \"reading_value\", \"type\": \"double\" },\n    { \"name\": \"status\"\
          , \"type\": \"string\" }\n  ]\n}\n"
    - id: complex-update
      name: UpdateRecord (Complex)
      type: org.apache.nifi.processors.standard.UpdateRecord
      position:
      - 400
      - 0
      properties:
        Record Reader: json-reader
        Record Writer: json-writer
        /status: UPPER(/status)
        /sensor: COALESCE(/sensor, 'unknown')
    - id: complex-query
      name: QueryRecord (Complex)
      type: org.apache.nifi.processors.standard.QueryRecord
      position:
      - 800
      - 0
      properties:
        record-reader: json-reader
        record-writer: json-writer
        high: SELECT * FROM FLOWFILE WHERE reading_value >= 50
        low: SELECT * FROM FLOWFILE WHERE reading_value < 50
    - id: complex-log-high
      name: LogAttribute (High)
      type: org.apache.nifi.processors.standard.LogAttribute
      position:
      - 1200
      - -200
    - id: complex-log-low
      name: LogAttribute (Low)
      type: org.apache.nifi.processors.standard.LogAttribute
      position:
      - 1200
      - 200
    - id: complex-log-failure
      name: LogAttribute (Complex Failure)
      type: org.apache.nifi.processors.standard.LogAttribute
      position:
      - 800
      - 300
    connections:
    - name: Complex Generate to Update
      source: complex-generate
      destination: complex-update
      relationships:
      - success
    - name: Complex Update to Query
      source: complex-update
      destination: complex-query
      relationships:
      - success
    - name: Complex Query to High Log
      source: complex-query
      destination: complex-log-high
      relationships:
      - high
    - name: Complex Query to Low Log
      source: complex-query
      destination: complex-log-low
      relationships:
      - low
    - name: Complex Query to Failure Log
      source: complex-query
      destination: complex-log-failure
      relationships:
      - failure
    auto_terminate:
      complex-log-high:
      - success
      complex-log-low:
      - success
      complex-log-failure:
      - success
  - name: NestedWorkflow
    position:
    - 3200
    - 0
    processors: []
    process_groups:
    - name: SubFunction
      position:
      - 0
      - 0
      processors:
      - id: nested-sub-generate
        name: Generate FlowFile (Sub)
        type: org.apache.nifi.processors.standard.GenerateFlowFile
        position:
        - 0
        - 0
        properties:
          Batch Size: '1'
      - id: nested-sub-log
        name: LogAttribute (Sub)
        type: org.apache.nifi.processors.standard.LogAttribute
        position:
        - 400
        - 0
      connections:
      - name: Sub Generate to Log
        source: nested-sub-generate
        destination: nested-sub-log
        relationships:
        - success
      auto_terminate:
        nested-sub-log:
        - success
  - name: NestedPortsWorkflow
    position:
    - 4000
    - 0
    processors:
    - id: nested-source
      name: Nested Source
      type: org.apache.nifi.processors.standard.GenerateFlowFile
      position:
      - 0
      - 0
      properties:
        Batch Size: '1'
        Data Format: Text
        Custom Text: nested payload
    - id: nested-result-log
      name: Nested Result Logger
      type: org.apache.nifi.processors.standard.LogAttribute
      position:
      - 1200
      - 0
    process_groups:
    - name: NestedPortsSubflow
      position:
      - 600
      - 0
      input_ports:
      - id: nested-sub-in
        name: Nested Sub In
        position:
        - 0
        - -100
      output_ports:
      - id: nested-sub-out
        name: Nested Sub Out
        position:
        - 400
        - -100
      processors:
      - id: nested-sub-log
        name: LogAttribute (Nested Sub)
        type: org.apache.nifi.processors.standard.LogAttribute
        position:
        - 200
        - 0
      connections:
      - name: Sub In to Log
        source: nested-sub-in
        destination: nested-sub-log
        relationships: []
      - name: Sub Log to Out
        source: nested-sub-log
        destination: nested-sub-out
        relationships:
        - success
    connections:
    - name: Source to Subflow
      source: nested-source
      destination: nested-sub-in
      relationships:
      - success
    - name: Subflow to Result
      source: nested-sub-out
      destination: nested-result-log
      relationships: []
    auto_terminate:
      nested-result-log:
      - success
